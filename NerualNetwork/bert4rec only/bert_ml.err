/data/lizongbu-slurm/anaconda3/envs/bert/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:131: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
  0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.094, N@5 0.183, N@10 0.243, R@1 0.094, R@5 0.281, R@10 0.469, M@1 0.094, M@5 0.151, M@10 0.176:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.109, N@5 0.222, N@10 0.276, R@1 0.109, R@5 0.328, R@10 0.500, M@1 0.109, M@5 0.187, M@10 0.208:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.130, N@5 0.235, N@10 0.290, R@1 0.130, R@5 0.339, R@10 0.510, M@1 0.130, M@5 0.201, M@10 0.223:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.129, N@5 0.235, N@10 0.290, R@1 0.129, R@5 0.336, R@10 0.508, M@1 0.129, M@5 0.202, M@10 0.225:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.134, N@5 0.236, N@10 0.292, R@1 0.134, R@5 0.331, R@10 0.506, M@1 0.134, M@5 0.205, M@10 0.228:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.122, N@5 0.219, N@10 0.275, R@1 0.122, R@5 0.310, R@10 0.482, M@1 0.122, M@5 0.189, M@10 0.213:   0%|          | 0/18 [00:00<?, ?it/s]Val: N@1 0.122, N@5 0.219, N@10 0.275, R@1 0.122, R@5 0.310, R@10 0.482, M@1 0.122, M@5 0.189, M@10 0.213:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.121, N@5 0.225, N@10 0.281, R@1 0.121, R@5 0.321, R@10 0.493, M@1 0.121, M@5 0.193, M@10 0.216:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.113, N@5 0.219, N@10 0.277, R@1 0.113, R@5 0.318, R@10 0.496, M@1 0.113, M@5 0.186, M@10 0.210:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.108, N@5 0.210, N@10 0.269, R@1 0.108, R@5 0.306, R@10 0.490, M@1 0.108, M@5 0.178, M@10 0.203:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.111, N@5 0.214, N@10 0.272, R@1 0.111, R@5 0.311, R@10 0.492, M@1 0.111, M@5 0.181, M@10 0.206:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.111, N@5 0.212, N@10 0.270, R@1 0.111, R@5 0.308, R@10 0.490, M@1 0.111, M@5 0.180, M@10 0.204:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.113, N@5 0.217, N@10 0.273, R@1 0.113, R@5 0.316, R@10 0.491, M@1 0.113, M@5 0.184, M@10 0.207:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.108, N@5 0.213, N@10 0.269, R@1 0.108, R@5 0.314, R@10 0.488, M@1 0.108, M@5 0.180, M@10 0.203:  33%|███▎      | 6/18 [00:00<00:00, 59.26it/s]Val: N@1 0.108, N@5 0.213, N@10 0.269, R@1 0.108, R@5 0.314, R@10 0.488, M@1 0.108, M@5 0.180, M@10 0.203:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.109, N@5 0.217, N@10 0.274, R@1 0.109, R@5 0.321, R@10 0.498, M@1 0.109, M@5 0.183, M@10 0.207:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.109, N@5 0.218, N@10 0.275, R@1 0.109, R@5 0.322, R@10 0.498, M@1 0.109, M@5 0.184, M@10 0.207:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.110, N@5 0.220, N@10 0.278, R@1 0.110, R@5 0.325, R@10 0.505, M@1 0.110, M@5 0.186, M@10 0.210:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.108, N@5 0.217, N@10 0.275, R@1 0.108, R@5 0.321, R@10 0.501, M@1 0.108, M@5 0.183, M@10 0.207:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.114, N@5 0.224, N@10 0.280, R@1 0.114, R@5 0.327, R@10 0.502, M@1 0.114, M@5 0.190, M@10 0.213:  72%|███████▏  | 13/18 [00:00<00:00, 59.57it/s]Val: N@1 0.114, N@5 0.224, N@10 0.280, R@1 0.114, R@5 0.327, R@10 0.502, M@1 0.114, M@5 0.190, M@10 0.213: 100%|██████████| 18/18 [00:00<00:00, 61.01it/s]
Traceback (most recent call last):
  File "main.py", line 23, in <module>
    train()
  File "main.py", line 18, in train
    trainer.test()
  File "/data/lizongbu-slurm/wushiguang/2021/ml/bert/bert4rec/trainers/base.py", line 186, in test
    json.dump(average_metrics.cpu().numpy(), f, indent=4)
AttributeError: 'dict' object has no attribute 'cpu'
